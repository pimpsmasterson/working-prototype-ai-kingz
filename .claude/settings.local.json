{
  "permissions": {
    "allow": [
      "Bash(dir:*)",
      "Bash(findstr:*)",
      "Bash(npm run coverage:*)",
      "Bash(npm test:*)",
      "Bash(npx nyc report:*)",
      "Bash(node -e:*)",
      "Bash(timeout 3 node:*)",
      "Bash(npx mocha:*)",
      "Bash(node server/vastai-proxy.js:*)",
      "Bash(timeout /t 3 /nobreak)",
      "Bash(curl:*)",
      "Bash(sqlite3:*)",
      "Bash(for i in 1 2 3 4 5 6)",
      "Bash(do echo \"Attempt $i...\")",
      "Bash(break)",
      "Bash(done)",
      "Bash(ConvertFrom-Json)",
      "Bash(ConvertTo-Json -Depth 3)",
      "Bash(powershell -Command \"taskkill /IM node.exe /F\")",
      "Bash(powershell -Command \"Invoke-RestMethod -Uri ''http://localhost:3000/api/proxy/warm-pool/prewarm'' -Method POST -Headers @{''x-admin-key''=''secure_admin_key_change_me''}\")",
      "Bash(Get-Process node -ErrorAction SilentlyContinue)",
      "Bash(Stop-Process -Force -ErrorAction SilentlyContinue)",
      "Bash(Write-Host \"Stopped node processes\")",
      "Bash(timeout 5 npm start:*)",
      "Bash(powershell -Command \"$env:VASTAI_API_KEY=''c0c517ae844d08ee03354fcf8cc9909eaaec857ed6e0a54128b3490a54808a4f''; node -e \"\"\nconst fetch = require\\(''node-fetch''\\);\nconst VASTAI_API_KEY = process.env.VASTAI_API_KEY;\nconsole.log\\(''API Key:'', VASTAI_API_KEY ? VASTAI_API_KEY.slice\\(0, 10\\) + ''...'' : ''NOT SET''\\);\n\n// Try minimal search to see what fields are valid\nconst searchParams = {\n    q: {\n        rentable: { eq: true },\n        rented: { eq: false },\n        dph_total: { lte: 0.80 },\n        gpu_ram: { gte: 8192 },\n        disk_space: { gte: 250 }\n    },\n    order: [[''dph_total'', ''asc'']],\n    type: ''ask''\n};\n\nfetch\\(''https://console.vast.ai/api/v0/bundles/'', {\n    method: ''POST'',\n    headers: {\n        ''Content-Type'': ''application/json'',\n        ''Authorization'': ''Bearer '' + VASTAI_API_KEY\n    },\n    body: JSON.stringify\\(searchParams\\)\n}\\).then\\(r => r.json\\(\\)\\).then\\(data => {\n    console.log\\(''Offers found:'', \\(data.offers || []\\).length\\);\n    if \\(data.offers && data.offers.length > 0\\) {\n        console.log\\(''Top 3 offers:''\\);\n        data.offers.slice\\(0, 3\\).forEach\\(\\(o, i\\) => {\n            console.log\\(\\(i+1\\) + ''. ID:'', o.id, ''GPU:'', o.gpu_name, ''VRAM:'', o.gpu_ram, ''Price:'', o.dph_total, ''Disk:'', o.disk_space\\);\n        }\\);\n    } else {\n        console.log\\(''Response:'', JSON.stringify\\(data, null, 2\\).slice\\(0, 500\\)\\);\n    }\n}\\).catch\\(e => console.error\\(''Error:'', e\\)\\);\n\"\"\")",
      "Bash(set VASTAI_API_KEY=c0c517ae844d08ee03354fcf8cc9909eaaec857ed6e0a54128b3490a54808a4f)",
      "Bash(npm install)",
      "Bash(npm run start:pm2:*)",
      "Bash(ls:*)",
      "Bash(grep:*)",
      "Bash(powershell.exe -Command \"Get-Process -Name node -ErrorAction SilentlyContinue | Where-Object { $_.MainWindowTitle -like ''*vastai*'' -or $true } | Select-Object Id, ProcessName, StartTime | Format-Table -AutoSize\")",
      "Bash(ssh -i ~/.ssh/id_rsa_vast -o StrictHostKeyChecking=no -p 16696 root@ssh7.vast.ai 'export CIVITAI_TOKEN=\"\"5b27198680e7f18ed806ca813826b62f\"\" && cd /workspace/ComfyUI/models && echo \"\"=== DOWNLOADING PONY V6 XL ===\"\" && wget -q --show-progress -O checkpoints/ponyDiffusionV6XL_v6StartWithThisOne.safetensors \"\"https://civitai.com/api/download/models/290640?token=${CIVITAI_TOKEN}\"\" 2>&1 && echo \"\"=== DOWNLOADING PONY REALISM LORA ===\"\" && wget -q --show-progress -O loras/pony_realism_v2.1.safetensors \"\"https://civitai.com/api/download/models/152309?token=${CIVITAI_TOKEN}\"\" 2>&1 && echo \"\"=== DONE ===\"\" && ls -lh checkpoints/pony* loras/pony*')",
      "Bash(ssh -i ~/.ssh/id_rsa_vast -o StrictHostKeyChecking=no -p 28304 root@ssh1.vast.ai \"export CIVITAI_TOKEN=5b27198680e7f18ed806ca813826b62f && cd /workspace/ComfyUI/models && echo ''=== Starting Pony V6 XL download ==='' && wget -q --show-progress -O checkpoints/ponyDiffusionV6XL_v6StartWithThisOne.safetensors ''https://civitai.com/api/download/models/290640?token=5b27198680e7f18ed806ca813826b62f'' 2>&1 && echo ''=== Pony V6 XL DONE ==='' && echo ''=== Starting Pony Realism LoRA ==='' && wget -q --show-progress -O loras/pony_realism_v2.1.safetensors ''https://civitai.com/api/download/models/152309?token=5b27198680e7f18ed806ca813826b62f'' 2>&1 && echo ''=== Pony Realism DONE ==='' && ls -la checkpoints/ loras/\")",
      "Bash(bash -n:*)",
      "WebFetch(domain:civitai.com)",
      "WebFetch(domain:gist.githubusercontent.com)",
      "Bash(git log:*)",
      "Bash(bash:*)",
      "Bash(pm2 list:*)",
      "Bash(test:*)",
      "Bash(pm2 delete:*)",
      "Bash(pkill:*)",
      "WebFetch(domain:github.com)",
      "Bash(powershell:*)",
      "Bash(node:*)",
      "Bash(pm2 restart:*)",
      "Bash(pm2 logs:*)",
      "Bash(git add:*)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nfix: Add SSH setup to warm-pool onstart & fix Windows NUL file bug\n\n- warm-pool.js: Add SSH directory setup to onstart command for proper key handling\n- Fix PowerShell scripts using /dev/null on Windows \\(creates NUL file bug\\)\n- Change all SSH UserKnownHostsFile from /dev/null to nul \\(Windows null device\\)\n- Affected files:\n  - one-click-start-fixed.ps1\n  - one-click-start.ps1\n  - scripts/powershell/check-and-install-missing.ps1\n  - scripts/powershell/investigate-failures.ps1\n\nThis ensures instances provision correctly with custom gist script and prevents\nreserved device name files from being created in the project root.\n\nCo-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(tasklist:*)",
      "Bash(Get-Process -Name node -ErrorAction SilentlyContinue)",
      "Bash(ssh -p 13586 -i /c/Users/samsc/.ssh/id_ed25519 root@ssh1.vast.ai \"\n# Download WAN 2.1 VAE model\nmkdir -p /workspace/ComfyUI/models/vae\ncd /workspace/ComfyUI/models/vae\n\nif [ ! -f wan_2.1_vae.safetensors ]; then\n  echo ''Downloading WAN 2.1 VAE model...''\n  wget -q --show-progress https://huggingface.co/Comfy-Org/Wan_2.2_ComfyUI_Repackaged/resolve/main/split_files/vae/wan_2.1_vae.safetensors\n  echo ''VAE downloaded successfully''\nelse\n  echo ''WAN VAE already exists''\nfi\n\nls -lh wan_2.1_vae.safetensors 2>&1 || echo ''Download in progress or failed''\n\")",
      "Bash(ssh -p 13586 -i /c/Users/samsc/.ssh/id_ed25519 root@ssh1.vast.ai \"\ncd /workspace/ComfyUI/custom_nodes\n\n# Configure git to use https without credentials for public repos\ngit config --global credential.helper store\n\necho ''=== Installing ComfyUI-Qwen_VQA ===''\nrm -rf ComfyUI-Qwen_VQA\nwget -q https://github.com/smthemex/ComfyUI-Qwen_VQA/archive/refs/heads/main.zip -O qwen.zip\nunzip -q qwen.zip\nmv ComfyUI-Qwen_VQA-main ComfyUI-Qwen_VQA\nrm qwen.zip\necho ''✓ Qwen VQA installed''\n\necho ''''\necho ''=== Installing ComfyUI-TripoSR ===''\nrm -rf ComfyUI-TripoSR\nwget -q https://github.com/VAST-AI-Research/TripoSR-ComfyUI/archive/refs/heads/main.zip -O triposr.zip\nunzip -q triposr.zip\nmv TripoSR-ComfyUI-main ComfyUI-TripoSR\nrm triposr.zip\necho ''✓ TripoSR installed''\n\necho ''''\necho ''=== Installing ComfyUI-Image-Resize ===''\nrm -rf ComfyUI-Image-Resize\nwget -q https://github.com/EllangoK/ComfyUI-Image-Resize/archive/refs/heads/main.zip -O resize.zip\nunzip -q resize.zip\nmv ComfyUI-Image-Resize-main ComfyUI-Image-Resize\nrm resize.zip\necho ''✓ Image Resize installed''\n\necho ''''\necho ''=== Installing dependencies ===''\nfor dir in ComfyUI-Qwen_VQA ComfyUI-TripoSR; do\n  if [ -f $dir/requirements.txt ]; then\n    echo \"\"Installing $dir requirements...\"\"\n    /venv/main/bin/pip install -q -r $dir/requirements.txt 2>&1 | head -5\n  fi\ndone\n\necho ''''\necho ''=== Verifying installations ===''\nls -ld ComfyUI-Qwen_VQA ComfyUI-TripoSR ComfyUI-Image-Resize 2>&1\n\necho ''''\necho ''=== All custom nodes installed! ===''\n\")"
    ]
  }
}
